<html>
    <head>
        <title>My first Three.js app</title>
        <style>canvas { width: 100%; height: 100% }</style>
    </head>
    
    <body>
        <script src="http://mrdoob.github.com/three.js/build/three.min.js"></script>
        <script src="https://stemkoski.github.io/Three.js/js/OrbitControls.js"></script>
        <script src="js/TrackballControls.js"></script>
        
        
        
        <script>
            function makeCube (x, y, z, cubeColor, useImage, student_num) {  //color based on year
                var geometry = new THREE.BoxGeometry(x, y, z);
                //var student_id = 2;
                
               var material = new THREE.MeshPhongMaterial( {color: cubeColor, specular: 0x555555, shininess: 100, emissive: 0x000000} );
               var newCube = new THREE.Mesh(geometry, material);
               
                if (useImage === true) {
                    var student_photo = "images/student" + student_num + ".jpg"  //load in the student number??
                    var materials = [
                        new THREE.MeshLambertMaterial({
                            map: new THREE.TextureLoader().load( 'images/red.png' ) }),   //x facing
                        new THREE.MeshLambertMaterial({
                            map: new THREE.TextureLoader().load( 'images/red.png' ) }),
                        new THREE.MeshLambertMaterial({
                            map: new THREE.TextureLoader().load( 'images/red.png' ) }),   //y facing
                        new THREE.MeshLambertMaterial({
                            map: new THREE.TextureLoader().load( 'images/red.png' ) }),
                        new THREE.MeshLambertMaterial({
                            map: new THREE.TextureLoader().load(student_photo) }),  //z facing
                        new THREE.MeshLambertMaterial( {
                            map: new THREE.TextureLoader().load( 'images/red.png' ) })
                    ];
                    
                    newCube = new THREE.Mesh( geometry, new THREE.MultiMaterial(materials))
                }
                
                
                return newCube;
            };
            
            //create group of year cubes for student
            function makeStudent(student_id, num_of_years) {
                //setup cubes and constants
                var cube_dim = 20;
                var year_colours = ["skyblue", "yellow", "green", "red", "purple", "pink"]
                var year_group = new THREE.Object3D();       //create an empty container
                
                
                for (i = 0; i < num_of_years; i++) {
                    var needs_face = false;
                    if (i ==0) {    //only first cube needs face
                        needs_face = true;
                    }
                    //create the year cube
                    var year = makeCube(cube_dim, cube_dim, cube_dim, new THREE.Color(year_colours[i]), needs_face, student_id);
                    
                    //translate it back
                    year.position.set(0,0, -(i*cube_dim));
                    
                    //add it to the student group of years
                    year_group.add(year);
                }
                
                //****PART OF THE STAIRCASE GEOMETRY*******
                //var year2 = makeCube(cube_dim, cube_dim*2, cube_dim, new THREE.Color('yellow'), false, student_id);
                //var year3 = makeCube(cube_dim, cube_dim*3, cube_dim, new THREE.Color('green'), false, student_id);
                //year2.position.set(0, (cube_dim/2), -cube_dim);
                //year3.position.set(0, cube_dim, -(2*cube_dim));
                
                return year_group;
            }
            
            //mouse movement
            var cursorX=0, oldCursorX;
            var cursorY=0, oldCursorY;
            document.onmousemove = function(e){
                oldCursorX = cursorX;
                oldCursorY = cursorY;
                
                cursorX = e.pageX;
                cursorY = e.pageY;
            }
            
            //key movement
            var camera_x = 10, camera_y = 30, camera_z = 80;
            
            document.onkeydown = function(e) {
               //z 
               if (e.which == 87) {
                    camera_z--;
               } else if (e.which == 83) {
                    camera_z++;
               }
               
               //x
               if (e.which == 68) {
                    camera_x++;
               } else if (e.which == 65) {
                    camera_x--;
               }
               
               //rotate y
               if (e.which == 82) { //r
                    camera.rotation.y++;
               } else if (e.which == 84) { //t
                    camera_x--;
               }
               
               console.log(e.which);
            }
            
            var loader = new THREE.TextureLoader();     //NEW method of loading textures
            var scene = new THREE.Scene();
            var renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);
            
            //add light source NEED FOR PHONG MATERIALS
            var light1 = new THREE.DirectionalLight( 0xffffff);
            var light2 = new THREE.DirectionalLight(0xffffff)
            light1.position.set(10, 70, 10);
            light2.position.set(-10, 70, 0);
            
            var ambientLight = new THREE.AmbientLight(0x111111, 20);
            ambientLight.position.set(0, 50, -5);
            
            //scene.add(light1);
            //scene.add(light2);
            scene.add(ambientLight);
            
            var axisHelper = new THREE.AxisHelper(70);
            scene.add( axisHelper );
            
            //set camera and mesh positions
            // Create a camera, zoom it out from the model a bit, and add it to the scene.
            var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 1, 10000);
            camera.position.set(50,16,50);
            scene.add(camera);
            
            //add meshes to scene
            var group = makeStudent(1,2);
            var group2 = makeStudent(2,5);
            var group3 = makeStudent(3,3);
            
            group2.position.set(20,0,0);    //improve this for animation**********
            group3.position.set(40,0,0);
            
            scene.add(group2);
            scene.add(group3);
            scene.add( group );//when done, add the group to the scene            
            
            camera.position.set(camera_x, camera_y, camera_z);
            var cameraControls;
            cameraControls = new THREE.TrackballControls(camera, renderer.domElement);
            cameraControls.target.set( 0, 0, 0 )
            var clock = new THREE.Clock();
            var delta;
            
            //main function
            function render() {
                requestAnimationFrame(render);                
                delta = clock.getDelta();
                cameraControls.update(delta);
                renderer.render(scene, camera);
            };
            
            //main loop called
            render();   
        </script>
    </body>
</html>